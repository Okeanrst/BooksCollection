<?php 
$title = $this->translate('Rubrics');
$this->headTitle($title);
?>
<h1><?php echo $this->escapeHtml($title) ?></h1>
<div id="flashMessage" class="hidden"></div>

<table class="table">
    <tr>
        <th><?php echo $this->translate('â„–') ?></th>
        <th><?php echo $this->translate('Title') ?></th>
        <th><?php echo $this->translate('Action') ?></th>                      
    </tr>
    <?php $i = 1;
    if (count($this->collection) > 0): ?>
        <?php foreach ($this->collection as $rubric): ?>
            <tr data-id="<?php echo $rubric->getId()?>">
                <td><?php echo $i++;?></td>
                <td><a href="<?php echo $this->url('books/getbooksbyrubric', array('id' => $rubric->getId())) ?>" >
                    <?php echo $rubric->getTitle() ?></a>
                </td>
                <td>
                <?php if ($this->zfcUserIdentity()): ?><a class="ajax" href="<?php echo $this->url('books/deleterubric', array('id' => $rubric->getId())) ?>" >X</a><?php endif; ?>
                </td>
            </tr>
        <?php endforeach ?>
    <?php endif ?>
</table>

<?php if ($this->collection) {
    echo $this->paginationControl($this->collection, 'sliding', 'partial/paginator', array());
} ?>

<div id="cover" class="hidden"></div>
<div id="ajaxcontainer" class="hidden">   
    <?php
    $title = 'Are you sure that you want to delete rubric';
    $formName = 'deleterubric';
    echo $this->partial('deleteform.phtml', ['title' => $title, 'name' => $formName ])
    ?>    
</div>

<script>
    var curUrl = '<?php echo $this->url() ?>';
    var reload = true; //reload page after action
    var url = '<?php echo $this->url('books/ajaxdeleterubric') ?>';
    var formName = '<?php echo $formName ?>';
    var error = '<?php echo $this->translate($this->flashMessenger()->render('error')) ?>';
    var success = '<?php echo $this->translate($this->flashMessenger()->render('success')) ?>';        
    var mess = $('#flashMessage');    

    $(document).ready(function() {               
        flashMessage(mess, error, success);
        $('.ajax').click(doAction);
    });

    
</script>